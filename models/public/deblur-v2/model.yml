# Copyright (c) 2020 Intel Corporation
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

description: >-
  DeblurGAN-v2 is a generative adversarial network (GAN) for single image motion deblurring.
  This model is based on a relativistic conditional GAN with a double-scale discriminator.
  Model used Inception-ResNet-v2 as backbone and was trained on GoPro dataset.
  For details about implementation of model,
  check out the DeblurGAN-v2: Deblurring (Orders-of-Magnitude) Faster and Better <https://github.com/VITA-Group/DeblurGANv2>
  repository.
task_type: image_processing
files:
  - name: models/__init__.py
    size: 0
    sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
    source: https://raw.githubusercontent.com/VITA-Group/DeblurGANv2/master/models/__init__.py
  - name: models/fpn_inception.py
    size: 6466
    sha256: baf7f973519c30644e6ba0f95ef73376963991c34bfc533e32dcc94fe15e51a0
    source: https://raw.githubusercontent.com/VITA-Group/DeblurGANv2/master/models/fpn_inception.py
  - name: models/networks.py
    size: 12779
    sha256: 3857345de80c42dedc5162d3e82a173160041cf4e0b307fd7e29680a1115d097
    source: https://raw.githubusercontent.com/VITA-Group/DeblurGANv2/master/models/networks.py
  - name: ckpt/deblur.h5
    size: 244480361
    sha256: 0ab85a0419534bca6c8bee65eff3c163313e647b4577d493d679aa31169b0eea
    source:
      $type: google_drive
      id: 1UXcsRVW-6KF23_TNzxw-xC0SzaMfXOaR
postprocessing:
  - $type: regex_replace
    file: models/networks.py
    pattern: 'from models\.(fpn_mobilenet|fpn_inception_simple|unet_seresnext|fpn_densenet) '
    replacement: '# \g<0>'
conversion_to_onnx_args:
  - --model-path=$config_dir
  - --model-path=$dl_dir
  - --model-name=DeblurV2
  - --import-module=model
  - --input-shape=1,3,736,1312
  - --output-file=$conv_dir/deblur-v2.onnx
  - --model-param=weights=r"$dl_dir/ckpt/deblur.h5"
  - --input-names=blur_image
  - --output-names=deblur_image
model_optimizer_args:
  - --reverse_input_channels
  - --input_shape=[1,3,736,1312]
  - --input=blur_image
  - --mean_values=blur_image[127.5,127.5,127.5]
  - --scale_values=blur_image[127.5,127.5,127.5]
  - --output=deblur_image
  - --input_model=$conv_dir/deblur-v2.onnx
framework: pytorch
license: https://raw.githubusercontent.com/CSAILVision/semantic-segmentation-pytorch/9aff40de31ee4b21f18514d31e5d6e4ba056924d/LICENSE
